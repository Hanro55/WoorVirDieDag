<!DOCTYPE html>
<html lang="af">
<head>
  <meta charset="UTF-8" />
  <title>Woord van die Dag üáøüá¶</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f3f4f6;
      --fg: #111;
      --tile-bg: #fff;
      --tile-border: #ccc;
      --green: #6aaa64;
      --yellow: #c9b458;
      --grey: #787c7e;
      --red: #dc2626;
    }
    [data-theme="dark"] {
      --bg: #111827;
      --fg: #f9fafb;
      --tile-bg: #1f2937;
      --tile-border: #374151;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--fg);
      margin: 0;
      padding: 1em;
      text-align: center;
      overflow-x: hidden;
      min-height: 100vh;
    }
    h1 {
      margin-top: 0;
      font-weight: 700;
    }
    #menuBtn {
      position: fixed;
      top: 15px;
      left: 15px;
      font-size: 2rem;
      cursor: pointer;
      z-index: 1100;
      background: var(--green);
      color: white;
      border: none;
      border-radius: 8px;
      width: 45px;
      height: 45px;
    }
    #sidebar {
      position: fixed;
      top: 0;
      left: -270px;
      width: 270px;
      height: 100%;
      background: var(--tile-bg);
      border-right: 2px solid var(--tile-border);
      padding: 1.5em 1em;
      box-sizing: border-box;
      transition: left 0.3s ease;
      box-shadow: 2px 0 10px rgba(0,0,0,0.3);
      z-index: 1099;
      color: var(--fg);
      overflow-y: auto;
    }
    #sidebar.open {
      left: 0;
    }
    #sidebar h2 {
      margin-top: 0;
      font-size: 1.5rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid var(--tile-border);
      padding-bottom: 0.5rem;
    }
    #sidebar button, #sidebar ul li {
      display: block;
      background: var(--green);
      color: white;
      border: none;
      padding: 10px;
      margin: 8px 0;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 8px;
      user-select: none;
    }
    #sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #sidebar ul li {
      background: var(--yellow);
      color: #222;
      border-radius: 6px;
      padding: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      font-weight: 600;
    }
    #sidebar ul li:hover {
      background: #bfa443;
    }
    #statsInfo {
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      max-width: 320px;
      margin: 3rem auto 1rem;
    }
    .tile {
      position: relative;
      width: 100%;
      padding-top: 100%;
      background: var(--tile-bg);
      border: 2px solid var(--tile-border);
      border-radius: 10px;
      text-transform: uppercase;
      font-weight: 700;
      font-size: 1.8rem;
      color: var(--fg);
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      transition: background-color 0.3s, border-color 0.3s, color 0.3s;
    }
    .correct {
      background-color: var(--green);
      border-color: var(--green);
      color: white;
    }
    .present {
      background-color: var(--yellow);
      border-color: var(--yellow);
      color: white;
    }
    .absent {
      background-color: var(--grey);
      border-color: var(--grey);
      color: white;
    }
    .invalid {
      background-color: var(--red);
      border-color: var(--red);
      color: white;
    }
    #keyboard {
      margin: 1rem auto;
      max-width: 320px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      justify-content: center;
      user-select: none;
    }
    .key {
      padding: 12px 14px;
      background: #ddd;
      border: none;
      border-radius: 8px;
      font-weight: 700;
      font-size: 1rem;
      text-transform: uppercase;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s;
    }
    .key.correct {
      background-color: var(--green);
      color: white;
    }
    .key.present {
      background-color: var(--yellow);
      color: white;
    }
    .key.absent {
      background-color: var(--grey);
      color: white;
    }
    .key:active {
      filter: brightness(0.9);
    }
    #inputRow {
      margin-top: 1rem;
    }
    #guessInput {
      width: 70%;
      max-width: 250px;
      font-size: 1.2rem;
      padding: 10px;
      border-radius: 12px;
      border: 2px solid var(--tile-border);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      text-align: center;
      user-select: text;
    }
    #submitBtn {
      margin-left: 10px;
      padding: 11px 20px;
      font-size: 1.1rem;
      background-color: var(--green);
      border: none;
      border-radius: 12px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      user-select: none;
    }
    #submitBtn:disabled {
      background-color: #a5d6a7;
      cursor: not-allowed;
    }
    #message {
      margin-top: 15px;
      font-weight: 700;
      height: 1.4em;
      color: var(--red);
    }
    /* Modal for statistics */
    #statsModal {
      display: none;
      position: fixed;
      z-index: 1200;
      left: 0; top: 0;
      width: 100%; height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5);
    }
    #statsModalContent {
      background-color: var(--tile-bg);
      margin: 8% auto;
      padding: 20px;
      border-radius: 12px;
      width: 90%;
      max-width: 480px;
      color: var(--fg);
      position: relative;
      box-shadow: 0 0 20px rgba(0,0,0,0.25);
      text-align: left;
    }
    #statsModalContent h2 {
      margin-top: 0;
      text-align: center;
    }
    #closeStatsBtn {
      position: absolute;
      top: 15px; right: 20px;
      font-size: 1.5rem;
      cursor: pointer;
      background: transparent;
      border: none;
      color: var(--fg);
    }
    #statsSummary p {
      margin: 0.2rem 0;
    }
    #graph {
      margin-top: 1rem;
    }
    .bar {
      background-color: var(--green);
      color: white;
      border-radius: 10px;
      padding: 5px 10px;
      margin: 3px 0;
      font-weight: 700;
      font-size: 1rem;
      user-select: none;
    }
    #shareButtons {
      margin-top: 15px;
      display: flex;
      justify-content: space-around;
      gap: 10px;
    }
    #shareButtons button {
      background: var(--green);
      border: none;
      color: white;
      font-weight: 700;
      font-size: 1rem;
      padding: 8px 14px;
      border-radius: 10px;
      cursor: pointer;
      user-select: none;
      flex-grow: 1;
    }
    /* Responsive */
    @media (max-width: 400px) {
      #board {
        max-width: 260px;
        gap: 6px;
      }
      .tile {
        font-size: 1.3rem;
      }
      #keyboard {
        max-width: 260px;
        gap: 5px;
      }
      .key {
        padding: 10px 11px;
        font-size: 0.9rem;
      }
      #guessInput {
        width: 65%;
        max-width: 160px;
        font-size: 1rem;
        padding: 8px;
      }
      #submitBtn {
        padding: 9px 14px;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body data-theme="light">

<button id="menuBtn" aria-label="Menu">&#9776;</button>

<div id="sidebar" aria-label="Sidebar menu" role="navigation" tabindex="-1">
  <h2>Woord vir die Dag üáøüá¶</h2>
  <div id="statsInfo">
    <p><strong>Spele gespeel:</strong> <span id="totalGames">0</span></p>
    <p><strong>Wensyfer:</strong> <span id="winRate">0%</span></p>
    <p><strong>Huidige streek:</strong> <span id="currentStreak">0</span></p>
    <p><strong>Langste streek:</strong> <span id="bestStreak">0</span></p>
  </div>
  <ul>
    <li id="statsBtn">üìä Statistiek</li>
    <li id="exportBtn">‚¨ÜÔ∏è Voer statistiek uit</li>
    <li id="importBtn">‚¨áÔ∏è Voer statistiek in</li>
    <li id="practiceBtn">üéØ Oefenmodus</li>
  </ul>
</div>

<h1>Woord vir die Dag üáøüá¶</h1>

<div id="board" aria-label="Raaiskoot bord" role="grid" aria-rowcount="6" aria-colcount="5"></div>

<div id="inputRow">
  <input type="text" id="guessInput" maxlength="5" aria-label="Raai woord" autocomplete="off" autocorrect="off" autocapitalize="characters" spellcheck="false" placeholder="Tik jou woord" />
  <button id="submitBtn" aria-label="Voer raaiskoot in">Voer in</button>
</div>

<div id="message" role="alert" aria-live="assertive"></div>

<div id="keyboard" aria-label="Sleutelbord"></div>

<!-- Statistiek Modal -->
<div id="statsModal" role="dialog" aria-modal="true" aria-labelledby="statsTitle">
  <div id="statsModalContent">
    <button id="closeStatsBtn" aria-label="Sluit Statistiek">&times;</button>
    <h2 id="statsTitle">Statistiek</h2>
    <div id="statsSummary"></div>
    <div id="graph"></div>
    <div id="shareButtons">
      <button id="copyAttemptBtn">üìã Kopieer poging</button>
      <button id="whatsappShareBtn">üü¢ Deel via WhatsApp</button>
    </div>
  </div>
</div>

<script>
(() => {
  const wordList = [
    "awery","awend","avorm","attar","atoom","atome","aflos","agter","akkom",
    "akker","akkie","alarm","alarm","alber","alder","alibi","aller","altes",
    "amper","amper","anker","antwoord","afwas"
    // Voeg meer 5-letter Afrikaanse woorde by soos jy wil
  ];

  const maxGuesses = 6;
  const wordLength = 5;
  let currentGuess = "";
  let guesses = [];
  let isGameOver = false;
  let todayWord = "";
  let stats = {
    total: 0,
    wins: 0,
    currentStreak: 0,
    bestStreak: 0,
    distribution: {1:0,2:0,3:0,4:0,5:0,6:0}
  };
  let practiceMode = false;

  // Elements
  const board = document.getElementById("board");
  const guessInput = document.getElementById("guessInput");
  const submitBtn = document.getElementById("submitBtn");
  const message = document.getElementById("message");
  const keyboard = document.getElementById("keyboard");
  const menuBtn = document.getElementById("menuBtn");
  const sidebar = document.getElementById("sidebar");
  const statsBtn = document.getElementById("statsBtn");
  const exportBtn = document.getElementById("exportBtn");
  const importBtn = document.getElementById("importBtn");
  const practiceBtn = document.getElementById("practiceBtn");
  const statsModal = document.getElementById("statsModal");
  const closeStatsBtn = document.getElementById("closeStatsBtn");
  const statsSummary = document.getElementById("statsSummary");
  const graph = document.getElementById("graph");
  const copyAttemptBtn = document.getElementById("copyAttemptBtn");
  const whatsappShareBtn = document.getElementById("whatsappShareBtn");
  const totalGamesSpan = document.getElementById("totalGames");
  const winRateSpan = document.getElementById("winRate");
  const currentStreakSpan = document.getElementById("currentStreak");
  const bestStreakSpan = document.getElementById("bestStreak");

  // Util: Shuffle array seeded by date so everyone gets same daily word
  function seededShuffle(arr, seed) {
    let a = arr.slice();
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(randomSeed(seed + i) * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  function randomSeed(seed) {
    var x = Math.sin(seed) * 10000;
    return x - Math.floor(x);
  }

  function getTodaySeed() {
    const today = new Date();
    return today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
  }

  function getWordForDate() {
    const seed = getTodaySeed();
    const shuffled = seededShuffle(wordList, seed);
    return shuffled[0];
  }

  // Load stats from localStorage
  function loadStats() {
    const saved = localStorage.getItem("woordStats");
    if (saved) {
      try {
        stats = JSON.parse(saved);
      } catch {}
    }
    updateStatsUI();
  }

  // Save stats to localStorage
  function saveStats() {
    localStorage.setItem("woordStats", JSON.stringify(stats));
  }

  // Update stats UI in sidebar
  function updateStatsUI() {
    totalGamesSpan.textContent = stats.total;
    winRateSpan.textContent = stats.total === 0 ? "0%" : Math.round((stats.wins / stats.total) * 100) + "%";
    currentStreakSpan.textContent = stats.currentStreak;
    bestStreakSpan.textContent = stats.bestStreak;
  }

  // Create board tiles
  function createBoard() {
    board.innerHTML = "";
    for (let i = 0; i < maxGuesses * wordLength; i++) {
      const tile = document.createElement("div");
      tile.classList.add("tile");
      tile.setAttribute("role","gridcell");
      board.appendChild(tile);
    }
  }

  // Render guesses on board
  function renderBoard() {
    const tiles = board.children;
    for (let i = 0; i < maxGuesses * wordLength; i++) {
      tiles[i].textContent = "";
      tiles[i].className = "tile";
    }

    guesses.forEach((guess, row) => {
      const evaluation = evaluateGuess(guess);
      for(let i=0; i < wordLength; i++) {
        const tile = tiles[row * wordLength + i];
        tile.textContent = guess[i].toUpperCase();
        tile.classList.add(evaluation[i]);
      }
    });
  }

  // Evaluate guess and return array of classes for each letter
  // "correct", "present", "absent"
  function evaluateGuess(guess) {
    let result = Array(wordLength).fill("absent");
    const wordChars = todayWord.split("");
    const guessChars = guess.split("");
    let letterCount = {};

    // Count letters in today's word
    wordChars.forEach(c => letterCount[c] = (letterCount[c] || 0) +1);

    // First pass: correct letters
    for (let i=0; i < wordLength; i++) {
      if (guessChars[i] === wordChars[i]) {
        result[i] = "correct";
        letterCount[guessChars[i]]--;
      }
    }

    // Second pass: present letters
    for (let i=0; i < wordLength; i++) {
      if (result[i] === "correct") continue;
      if (letterCount[guessChars[i]] > 0) {
        result[i] = "present";
        letterCount[guessChars[i]]--;
      }
    }

    return result;
  }

  // Keyboard state to color keys after guesses
  let keyStates = {};

  // Render keyboard keys
  function renderKeyboard() {
    keyboard.innerHTML = "";
    const keys = "qwertyuiopasdfghjklzxcvbnm".split("");
    keys.forEach(k => {
      const btn = document.createElement("button");
      btn.textContent = k.toUpperCase();
      btn.className = "key";
      if (keyStates[k]) btn.classList.add(keyStates[k]);
      btn.addEventListener("click", () => {
        if(isGameOver) return;
        guessInput.value += k.toUpperCase();
        guessInput.focus();
      });
      keyboard.appendChild(btn);
    });

    // Backspace key
    const backspaceBtn = document.createElement("button");
    backspaceBtn.textContent = "‚Üê";
    backspaceBtn.className = "key";
    backspaceBtn.addEventListener("click", () => {
      if(isGameOver) return;
      guessInput.value = guessInput.value.slice(0, -1);
      guessInput.focus();
    });
    keyboard.appendChild(backspaceBtn);
  }

  // Update keyboard colors from guesses
  function updateKeyboardStates() {
    keyStates = {};
    guesses.forEach(guess => {
      const evaluation = evaluateGuess(guess);
      for(let i=0; i < wordLength; i++) {
        const l = guess[i];
        if(evaluation[i] === "correct") {
          keyStates[l] = "correct";
        } else if(evaluation[i] === "present") {
          if(keyStates[l] !== "correct") keyStates[l] = "present";
        } else {
          if(!keyStates[l]) keyStates[l] = "absent";
        }
      }
    });
    renderKeyboard();
  }

  // Show message to user
  function showMessage(text, isError = true) {
    message.textContent = text;
    message.style.color = isError ? "var(--red)" : "var(--green)";
  }

  // Clear message
  function clearMessage() {
    message.textContent = "";
  }

  // Check if word is valid (in wordList)
  function isValidWord(word) {
    return wordList.includes(word.toLowerCase());
  }

  // Save guesses to localStorage
  function saveGame() {
    localStorage.setItem("woordGuesses", JSON.stringify(guesses));
    localStorage.setItem("woordDate", getTodaySeed());
  }

  // Load guesses from localStorage
  function loadGame() {
    const savedDate = Number(localStorage.getItem("woordDate"));
    const today = getTodaySeed();
    if (savedDate !== today) {
      guesses = [];
      saveGame();
      return;
    }
    const savedGuesses = JSON.parse(localStorage.getItem("woordGuesses") || "[]");
    guesses = savedGuesses;
  }

  // Save stats after game ends
  function saveStats(won) {
    stats.total++;
    if(won) {
      stats.wins++;
      stats.currentStreak++;
      if(stats.currentStreak > stats.bestStreak) stats.bestStreak = stats.currentStreak;
      const attempts = guesses.length;
      stats.distribution[attempts] = (stats.distribution[attempts] || 0) + 1;
    } else {
      stats.currentStreak = 0;
    }
    saveStatsToStorage();
  }

  // Save stats to localStorage
  function saveStatsToStorage() {
    localStorage.setItem("woordStats", JSON.stringify(stats));
    updateStatsUI();
  }

  // Load stats from localStorage
  function loadStatsFromStorage() {
    const saved = localStorage.getItem("woordStats");
    if(saved) {
      try {
        stats = JSON.parse(saved);
      } catch {}
    }
    updateStatsUI();
  }

  // Update sidebar stats text
  function updateStatsUI() {
    totalGamesSpan.textContent = stats.total;
    winRateSpan.textContent = stats.total ? Math.round((stats.wins / stats.total)*100) + "%" : "0%";
    currentStreakSpan.textContent = stats.currentStreak;
    bestStreakSpan.textContent = stats.bestStreak;
  }

  // Show stats modal
  function showStatsModal() {
    // Build summary
    let summaryHTML = `
      <p><strong>Spele Gespeel:</strong> ${stats.total}</p>
      <p><strong>Wenkoers:</strong> ${stats.total ? Math.round((stats.wins / stats.total)*100) + "%" : "0%"}</p>
      <p><strong>Huidige Streek:</strong> ${stats.currentStreak}</p>
      <p><strong>Langste Streek:</strong> ${stats.bestStreak}</p>
      <h3>Wins verspreiding:</h3>
    `;
    statsSummary.innerHTML = summaryHTML;

    // Build graph bars
    graph.innerHTML = "";
    for(let i=1; i<=maxGuesses; i++) {
      const count = stats.distribution[i] || 0;
      const barWidth = Math.min(count * 30, 270); // max width
      const bar = document.createElement("div");
      bar.className = "bar";
      bar.style.width = barWidth + "px";
      bar.textContent = `${i} pogings: ${count}`;
      graph.appendChild(bar);
    }

    statsModal.style.display = "block";
  }

  // Hide stats modal
  function hideStatsModal() {
    statsModal.style.display = "none";
  }

  // Share attempt text for clipboard and WhatsApp
  function getShareText() {
    let text = `Woord van die Dag - My poging:\n`;
    guesses.forEach(guess => {
      const evals = evaluateGuess(guess);
      for(let i=0; i < wordLength; i++) {
        if(evals[i] === "correct") text += "üü©";
        else if(evals[i] === "present") text += "üü®";
        else text += "‚¨ú";
      }
      text += "\n";
    });
    text += `Spele gespeel: ${stats.total}, Wensyfer: ${winRateSpan.textContent}`;
    return text;
  }

  // Copy to clipboard
  async function copyToClipboard() {
    try {
      await navigator.clipboard.writeText(getShareText());
      alert("Poging gekopieer na knipbord!");
    } catch (err) {
      alert("Kan nie kopieer nie, probeer weer.");
    }
  }

  // Share to WhatsApp
  function shareWhatsApp() {
    const text = encodeURIComponent(getShareText());
    const url = `https://wa.me/?text=${text}`;
    window.open(url, "_blank");
  }

  // Submit guess
  function submitGuess() {
    if (isGameOver) return;
    const guess = guessInput.value.trim().toLowerCase();

    if (guess.length !== wordLength) {
      showMessage(`Die woord moet presies ${wordLength} letters wees.`);
      return;
    }
    if (!isValidWord(guess)) {
      showMessage("Ongeldige woord, probeer weer.");
      return;
    }
    if (guesses.includes(guess)) {
      showMessage("Jy het hierdie woord al probeer.");
      return;
    }
    clearMessage();
    guesses.push(guess);
    saveGame();
    renderBoard();
    updateKeyboardStates();
    guessInput.value = "";
    guessInput.focus();

    if (guess === todayWord) {
      isGameOver = true;
      showMessage("Geluk! Jy het die woord reg gekry! üéâ", false);
      saveStats(true);
      updateStatsUI();
      setTimeout(() => showStatsModal(), 1200);
      return;
    }
    if (guesses.length >= maxGuesses) {
      isGameOver = true;
      showMessage(`Game oor! Die woord was: ${todayWord.toUpperCase()}`, true);
      saveStats(false);
      updateStatsUI();
      setTimeout(() => showStatsModal(), 1500);
    }
  }

  // Initialize game
  function initGame() {
    todayWord = getWordForDate();
    loadStatsFromStorage();
    loadGame();
    createBoard();
    renderBoard();
    updateKeyboardStates();
    if(guesses.length >= maxGuesses || guesses.includes(todayWord)) {
      isGameOver = true;
    }
    guessInput.focus();
  }

  // Toggle sidebar
  menuBtn.addEventListener("click", () => {
    sidebar.classList.toggle("open");
  });

  // Sidebar buttons
  statsBtn.addEventListener("click", () => {
    sidebar.classList.remove("open");
    showStatsModal();
  });

  closeStatsBtn.addEventListener("click", () => {
    hideStatsModal();
  });

  exportBtn.addEventListener("click", () => {
    const exportData = {
      guesses,
      stats,
      date: getTodaySeed()
    };
    const json = JSON.stringify(exportData, null, 2);
    navigator.clipboard.writeText(json)
      .then(() => alert("Statistiek gekopieer na knipbord!"))
      .catch(() => alert("Kon nie kopieer nie."));
  });

  importBtn.addEventListener("click", () => {
    const importData = prompt("Plak jou statistiek data hier:");
    if (!importData) return;
    try {
      const parsed = JSON.parse(importData);
      if (parsed.guesses && parsed.stats) {
        guesses = parsed.guesses;
        stats = parsed.stats;
        saveGame();
        saveStatsToStorage();
        renderBoard();
        updateKeyboardStates();
        updateStatsUI();
        alert("Statistiek ingevoer!");
      } else {
        alert("Ongeldige data.");
      }
    } catch {
      alert("Ongeldige JSON formaat.");
    }
  });

  practiceBtn.addEventListener("click", () => {
    alert("Oefenmodus nog nie beskikbaar nie.");
  });

  submitBtn.addEventListener("click", submitGuess);
  guessInput.addEventListener("keyup", (e) => {
    if (e.key === "Enter") {
      submitGuess();
    }
  });

  copyAttemptBtn.addEventListener("click", copyToClipboard);
  whatsappShareBtn.addEventListener("click", shareWhatsApp);

  // Close stats modal if click outside content
  statsModal.addEventListener("click", (e) => {
    if (e.target === statsModal) hideStatsModal();
  });

  // Initialize keyboard
  renderKeyboard();

  // Start game
  initGame();

})();
</script>

</body>
</html>





